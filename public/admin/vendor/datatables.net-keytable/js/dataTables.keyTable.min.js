!function(n){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return n(e,window,document)}):"object"==typeof exports?module.exports=function(e,t){return e=e||window,t&&t.fn.dataTable||(t=require("datatables.net")(e,t).$),n(t,e,e.document)}:n(jQuery,window,document)}(function(c,u,d,f){var i=c.fn.dataTable,l=function(e,t){if(!i.versionCheck||!i.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=c.extend(!0,{},i.defaults.keyTable,l.defaults,t),this.s={dt:new i.Api(e),enable:!0,focusDraw:!1,waitingForDraw:!1,lastFocus:null},this.dom={};var n=this.s.dt.settings()[0],s=n.keytable;if(s)return s;(n.keytable=this)._constructor()};return c.extend(l.prototype,{blur:function(){this._blur()},enable:function(e){this.s.enable=e},focus:function(e,t){this._focus(this.s.dt.cell(e,t))},focused:function(e){if(!this.s.lastFocus)return!1;var t=this.s.lastFocus.cell.index();return e.row===t.row&&e.column===t.column},_constructor:function(){this._tabInput();var l=this,i=this.s.dt,e=c(i.table().node());if("static"===e.css("position")&&e.css("position","relative"),c(i.table().body()).on("click.keyTable","th, td",function(e){if(!1!==l.s.enable){var t=i.cell(this);t.any()&&l._focus(t,null,!1,e)}}),c(d).on("keydown.keyTable",function(e){l._key(e)}),this.c.blurable&&c(d).on("mousedown.keyTable",function(e){c(e.target).parents(".dataTables_filter").length&&l._blur(),c(e.target).parents().filter(i.table().container()).length||c(e.target).parents("div.DTE").length||c(e.target).parents("div.editor-datetime").length||c(e.target).parents().filter(".DTFC_Cloned").length||l._blur()}),this.c.editor){var n=this.c.editor;n.on("open.keyTableMain",function(e,t){"inline"!==t&&l.s.enable&&(l.enable(!1),n.one("close.keyTable",function(){l.enable(!0)}))}),this.c.editOnFocus&&i.on("key-focus.keyTable key-refocus.keyTable",function(e,t,n,s){l._editor(null,s,!0)}),i.on("key.keyTable",function(e,t,n,s,i){l._editor(n,i,!1)}),c(i.table().body()).on("dblclick.keyTable","th, td",function(e){!1!==l.s.enable&&i.cell(this).any()&&l._editor(null,e,!0)})}i.settings()[0].oFeatures.bStateSave&&i.on("stateSaveParams.keyTable",function(e,t,n){n.keyTable=l.s.lastFocus?l.s.lastFocus.cell.index():null}),i.on("draw.keyTable",function(e){if(!l.s.focusDraw&&((t=l.s.lastFocus)&&t.node&&c(t.node).closest("body")===d.body)){var t=l.s.lastFocus.relative,n=i.page.info(),s=t.row+n.start;0!==n.recordsDisplay&&(s>=n.recordsDisplay&&(s=n.recordsDisplay-1),l._focus(s,t.column,!0,e))}}),this.c.clipboard&&this._clipboard(),i.on("destroy.keyTable",function(){i.off(".keyTable"),c(i.table().body()).off("click.keyTable","th, td"),c(d).off("keydown.keyTable").off("click.keyTable").off("copy.keyTable").off("paste.keyTable")});var t=i.state.loaded();t&&t.keyTable?i.one("init",function(){var e=i.cell(t.keyTable);e.any()&&e.focus()}):this.c.focus&&i.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var e=this.s.lastFocus.cell;c(e.node()).removeClass(this.c.className),this.s.lastFocus=null,this._updateFixedColumns(e.index().column),this._emitEvent("key-blur",[this.s.dt,e])}},_clipboard:function(){var l=this.s.dt,a=this;u.getSelection&&(c(d).on("copy.keyTable",function(e){e=e.originalEvent;var t=u.getSelection().toString(),n=a.s.lastFocus;!t&&n&&(e.clipboardData.setData("text/plain",n.cell.render(a.c.clipboardOrthogonal)),e.preventDefault())}),c(d).on("paste.keyTable",function(e){e=e.originalEvent;var t,n=a.s.lastFocus,s=d.activeElement,i=a.c.editor;!n||s&&"body"!==s.nodeName.toLowerCase()||(e.preventDefault(),u.clipboardData&&u.clipboardData.getData?t=u.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),i?i.inline(n.cell.index()).set(i.displayed()[0],t).submit():(n.cell.data(t),l.draw(!1)))}))},_columns:function(){var e=this.s.dt,t=e.columns(this.c.columns).indexes(),n=[];return e.columns(":visible").every(function(e){-1!==t.indexOf(e)&&n.push(e)}),n},_editor:function(e,t,n){var s=this,i=this.s.dt,l=this.c.editor,a=this.s.lastFocus.cell;if(!(c("div.DTE",a.node()).length||null!==e&&(0<=e&&e<=9||11===e||12===e||14<=e&&e<=31||112<=e&&e<=123||127<=e&&e<=159))){t.stopPropagation(),13===e&&t.preventDefault();function o(){l.one("open.keyTable",function(){l.off("cancelOpen.keyTable"),n||c("div.DTE_Field_InputControl input, div.DTE_Field_InputControl textarea").select(),i.keys.enable(n?"tab-only":"navigation-only"),i.on("key-blur.editor",function(){l.displayed()&&l.submit()}),n&&c(i.table().container()).addClass("dtk-focus-alt"),l.on("submitUnsuccessful.keyTable",function(){s._focus(a,null,!1)}),l.one("close",function(){i.keys.enable(!0),i.off("key-blur.editor"),l.off(".keyTable"),c(i.table().container()).removeClass("dtk-focus-alt")})}).one("cancelOpen.keyTable",function(){l.off(".keyTable")}).inline(a.index())}13===e?(n=!0,c(d).one("keyup",function(){o()})):o()}},_emitEvent:function(t,n){this.s.dt.iterator("table",function(e){c(e.nTable).triggerHandler(t,n)})},_focus:function(e,t,n,s){var i=this,l=this.s.dt,a=l.page.info(),o=this.s.lastFocus;if(s=s||null,this.s.enable){if("number"!=typeof e){if(!e.any())return;var r=e.index();t=r.column;if((e=l.rows({filter:"applied",order:"applied"}).indexes().indexOf(r.row))<0)return;a.serverSide&&(e+=a.start)}if(-1!==a.length&&(e<a.start||e>=a.start+a.length))this.s.focusDraw=!0,this.s.waitingForDraw=!0,l.one("draw",function(){i.s.focusDraw=!1,i.s.waitingForDraw=!1,i._focus(e,t,f,s)}).page(Math.floor(e/a.length)).draw(!1);else if(-1!==c.inArray(t,this._columns())){if(a.serverSide&&(e-=a.start),a=l.cells(null,t,{search:"applied",order:"applied"}).flatten(),a=l.cell(a[e]),o){if(o.node===a.node())return void this._emitEvent("key-refocus",[this.s.dt,a,s||null]);this._blur()}(o=c(a.node())).addClass(this.c.className),this._updateFixedColumns(t),n!==f&&!0!==n||(this._scroll(c(u),c(d.body),o,"offset"),(n=l.table().body().parentNode)!==l.table().header().parentNode&&(n=c(n.parentNode),this._scroll(n,n,o,"position"))),this.s.lastFocus={cell:a,node:a.node(),relative:{row:l.rows({page:"current"}).indexes().indexOf(a.index().row),column:a.index().column}},this._emitEvent("key-focus",[this.s.dt,a,s||null]),l.state.save()}}},_key:function(e){if(this.s.waitingForDraw)e.preventDefault();else{var t=this.s.enable,n=!0===t||"navigation-only"===t;if(t&&(!(0===e.keyCode||e.ctrlKey||e.metaKey||e.altKey)||e.ctrlKey&&e.altKey)&&this.s.lastFocus){var s=this.s.dt,i=!!this.s.dt.settings()[0].oScroll.sY;if(!this.c.keys||-1!==c.inArray(e.keyCode,this.c.keys))switch(e.keyCode){case 9:this._shift(e,e.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&!0===t&&this._blur();break;case 33:case 34:n&&!i&&(e.preventDefault(),s.page(33===e.keyCode?"previous":"next").draw(!1));break;case 35:case 36:n&&(e.preventDefault(),t=s.cells({page:"current"}).indexes(),n=this._columns(),this._focus(s.cell(t[35===e.keyCode?t.length-1:n[0]]),null,!0,e));break;case 37:n&&this._shift(e,"left");break;case 38:n&&this._shift(e,"up");break;case 39:n&&this._shift(e,"right");break;case 40:n&&this._shift(e,"down");break;default:!0===t&&this._emitEvent("key",[s,e.keyCode,this.s.lastFocus.cell,e])}}}},_scroll:function(e,t,n,s){var i=n[s](),l=n.outerHeight(),a=n.outerWidth(),o=t.scrollTop(),r=t.scrollLeft(),c=e.height();e=e.width();"position"===s&&(i.top+=parseInt(n.closest("table").css("top"),10)),i.top<o&&t.scrollTop(i.top),i.left<r&&t.scrollLeft(i.left),i.top+l>o+c&&l<c&&t.scrollTop(i.top+l-c),i.left+a>r+e&&a<e&&t.scrollLeft(i.left+a-e)},_shift:function(e,t,n){var s=this.s.dt,i=s.page.info(),l=i.recordsDisplay,a=this.s.lastFocus.cell,o=this._columns();if(a){var r=s.rows({filter:"applied",order:"applied"}).indexes().indexOf(a.index().row);i.serverSide&&(r+=i.start),i=o[s=s.columns(o).indexes().indexOf(a.index().column)],"right"===t?i=s>=o.length-1?(r++,o[0]):o[s+1]:"left"===t?i=0===s?(r--,o[o.length-1]):o[s-1]:"up"===t?r--:"down"===t&&r++,0<=r&&r<l&&-1!==c.inArray(i,o)?(e.preventDefault(),this._focus(r,i,!0,e)):n&&this.c.blurable?this._blur():e.preventDefault()}},_tabInput:function(){var t=this,n=this.s.dt,e=null!==this.c.tabIndex?this.c.tabIndex:n.settings()[0].iTabIndex;-1!=e&&c('<div><input type="text" tabindex="'+e+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(n.table().node()).children().on("focus",function(e){n.cell(":eq(0)",{page:"current"}).any()&&t._focus(n.cell(":eq(0)","0:visible",{page:"current"}),null,!0,e)})},_updateFixedColumns:function(e){var t=this.s.dt,n=t.settings()[0];if(n._oFixedColumns){var s=n.aoColumns.length-n._oFixedColumns.s.iRightColumns;(e<n._oFixedColumns.s.iLeftColumns||s<=e)&&t.fixedColumns().update()}}}),l.defaults={blurable:!0,className:"focus",clipboard:!0,clipboardOrthogonal:"display",columns:"",editor:null,editOnFocus:!1,focus:null,keys:null,tabIndex:null},l.version="2.5.0",c.fn.dataTable.KeyTable=l,c.fn.DataTable.KeyTable=l,i.Api.register("cell.blur()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.blur()})}),i.Api.register("cell().focus()",function(){return this.iterator("cell",function(e,t,n){e.keytable&&e.keytable.focus(t,n)})}),i.Api.register("keys.disable()",function(){return this.iterator("table",function(e){e.keytable&&e.keytable.enable(!1)})}),i.Api.register("keys.enable()",function(t){return this.iterator("table",function(e){e.keytable&&e.keytable.enable(t===f||t)})}),i.ext.selector.cell.push(function(e,t,n){t=t.focused;var s=[];if(!(e=e.keytable)||t===f)return n;for(var i=0,l=n.length;i<l;i++)(!0===t&&e.focused(n[i])||!1===t&&!e.focused(n[i]))&&s.push(n[i]);return s}),c(d).on("preInit.dt.dtk",function(e,t){if("dt"===e.namespace){var n=t.oInit.keys,s=i.defaults.keys;(n||s)&&(s=c.extend({},s,n),!1!==n&&new l(t,s))}}),l});